;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-intermediate-reader.ss" "lang")((modname Sail) (read-case-sensitive #t) (teachpacks ((lib "image.rkt" "teachpack" "2htdp"))) (htdp-settings #(#t constructor repeating-decimal #f #t none #f ((lib "image.rkt" "teachpack" "2htdp")))))
;; Code for Radioactive by Imagine Dragons
(require rsound)
(require rsound/piano-tones)

; Useful functions
(define (both a b) b)
(define ps (make-pstream))

; A note is (make-note string note-num number number) where
; note-nume is the midi note number,
; the first number is the time the note is played, and
; the last number is the duration of the note
(define-struct note (note-num time duration))

; Plays the notes in a list of notes
; List -> pstream struct
(define (play-song l-o-n)
  (cond
    [(empty? l-o-n) empty]
    [(cons? l-o-n) (both (play-note (first l-o-n)) (play-song (rest l-o-n)))]
    ))

; Plays a single note from the list
; note  -> pstream
(define (play-note n)
  (local [(define sound1 (piano-tone (note-note-num n)))]
    (pstream-queue ps 
                   (clip sound1 0 (min (rs-frames sound1)
                                       (note-duration n)))
                   (note-time n))))